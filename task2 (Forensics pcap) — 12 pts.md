## Описание

Злоумышленник организовал скрытый канал передачи видеопотока с использованием протокола UDP. Нужно определить способ кодирования и найти секретный ключ.

Дамп трафика: https://disk.yandex.ru/d/tZZtFP28QF1lVA

формат ответа: itmo{...}

## Решение
Трафик состоит из одного потока UDP, и мы замечаем, что каждый передаваемый пакет представляет собой изображение (что имеет смысл, поскольку видео по сути представляет собой набор фотографий). 
Делаем Follow UDP stream - Show data as Hex Dump. Сигнатура файла показывает, что мы имеем дело с файлами JPEG.

![image](https://user-images.githubusercontent.com/49597727/146970353-c013a19f-f3ca-4f5d-9783-275784d71c49.png)

Поскольку в этом потоке 2999 пакетов, нам придется использовать утилит **tshark** для их автоматического извлечения.

``tshark -r bak5.pcap -T fields -e data.data > hex.dump``

(т.е. мы храним весь переданный hex дамп в файле hex.dump). Затем мы просто конвертируем каждый hex дамп (в файле htx.dump)в соответствующий файл (в нашем случае файл JPEG). Это делается с помощью команды xxd. Bash script для этого выглядит так:
```
i=0 
while IFS= read -r line
do 
  printf '%s\n' "$line" |xxd -r -p > $i.jpg
  i=$((i+1))
done < hex.dump
 ```
 


