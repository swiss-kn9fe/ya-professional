## Описание

Злоумышленник организовал скрытый канал передачи видеопотока с использованием протокола UDP. Нужно определить способ кодирования и найти секретный ключ.

Дамп трафика: https://disk.yandex.ru/d/tZZtFP28QF1lVA (если ссылка больше недействительна, используйте файл pcap (bak5.pcap) в bak5.zip в главном каталоге)

формат ответа: itmo{...}

## Решение
Трафик состоит из одного потока UDP, и мы замечаем, что каждый передаваемый пакет представляет собой изображение (что имеет смысл, поскольку видео по сути представляет собой набор фотографий). 
Делаем Follow UDP stream - Show data as Hex Dump. Сигнатура файла ``FF D8 FF E0 00 10 4A 46 49 46 00 01`` показывает, что мы имеем дело с файлами JPEG.

![image](https://user-images.githubusercontent.com/49597727/146970353-c013a19f-f3ca-4f5d-9783-275784d71c49.png)

### Способ 1 (тот, о котором я узнал после состязания)
Использование Binwalk
```binwalk --dd=".*" bak5.pcap```
Затем можем просмотреть фотографии и найти флаг на некоторых из них.
#### Примечание:
Хотя этот подход кажется самым простым, проблема в том, что для извлечения всех этих фотографий требуется некоторое время (в зависимости от скорости вашего процессора наверно). Мне потребовалось примерно 12 минут, но моему приятелю потребовалось меньше). Кроме того, убедитесь, что у вас на диске более 50 ГБ свободного места, так как фотографии будут примерно такого размера (знаю, это безумие!).

### Способ 2 (подход, который я использовал)
Поскольку в этом потоке 2999 пакетов, нам придется использовать утилит **tshark** для их автоматического извлечения.

``tshark -r bak5.pcap -T fields -e data.data > hex.dump``

т.е. мы храним весь переданный hex дамп в файле hex.dump. Затем мы преобразуем каждую шестнадцатеричную строку (в файле hex.dump) в соответствующий файл (в нашем случае файл JPEG). Это делается с помощью команды xxd. Bash script для этого выглядит так:
```
i=0 
while IFS= read -r line
do 
  printf '%s\n' "$line" |xxd -r -p > $i.jpg
  i=$((i+1))
done < hex.dump
 ```
 Теперь получаем 2999 фотографий в формате JPEG. Флаг печатается в виде текста на фотографиях в интервале 2319.jpg-2421.jpg. Если не хотим просматривать все эти фотографии, можем использовать ПО, такое как Blender (или любой другой подобный инструмент), для преобразования фотографий в видео. Когда я это сделал, флаг был найден в промежутке 01:36-01:41.
![image](https://user-images.githubusercontent.com/49597727/147000546-8f7358fb-4d61-483f-8437-7de93f397ff0.png)

#### Примечание: 
Если используете Blender, предпочтительно выберите "без потерь" ("Lossless") или "практически без потерь" ("perceptually lossless") в качестве типа сжатия. Это гарантирует, что биты (изображения) существенно не изменятся во время сжатия, так как вы, в свою очередь, можете потерять потенциально полезные данные.


